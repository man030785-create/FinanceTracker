{% extends "base.html" %}
{% block title %}Dashboard – FinanceTracker{% endblock %}
{% block content %}
<div class="page-header">
  <h1>Dashboard</h1>
  <div class="actions">
    <a href="{{ request.url_for('transaction_new') }}" class="button btn-primary">Add transaction</a>
  </div>
</div>
{% if alerts %}
<section class="section section--alerts">
  <h2 class="section-title">Alerts</h2>
  <div class="alerts-list">
    {% for a in alerts %}
    <div class="alert alert--{{ a.severity }}" role="alert">
      <strong>{{ a.title }}</strong>
      <p class="alert-message">{{ a.message }}</p>
      {% if a.kind == 'large_transaction' and a.transaction_id %}
      <p class="alert-meta"><a href="{{ request.url_for('transactions_list') }}">View transactions</a></p>
      {% endif %}
    </div>
    {% endfor %}
  </div>
  <p><a href="{{ request.url_for('alerts_page') }}">View all alerts</a></p>
</section>
{% endif %}
<div class="summary-cards">
  <div class="card card--stat card--income">
    <span class="card-label">Income (this month)</span>
    <span class="card-value">{{ "%.2f"|format(summary.total_income|float) }}</span>
  </div>
  <div class="card card--stat card--expense">
    <span class="card-label">Expenses (this month)</span>
    <span class="card-value">{{ "%.2f"|format(summary.total_expenses|float) }}</span>
  </div>
  <div class="card card--stat card--savings">
    <span class="card-label">Net savings</span>
    <span class="card-value">{{ "%.2f"|format(summary.net_savings|float) }}</span>
  </div>
  <div class="card card--stat card--savings">
    <span class="card-label">Savings rate</span>
    <span class="card-value">{{ summary.savings_rate }}%</span>
  </div>
</div>
<section class="section">
  <h2 class="section-title">Recent transactions</h2>
  {% if recent_transactions %}
  <div class="table-wrap">
    <table class="table">
      <thead>
        <tr><th>Date</th><th>Type</th><th>Category</th><th>Amount</th><th>Description</th></tr>
      </thead>
      <tbody>
      {% for t in recent_transactions %}
        <tr>
          <td>{{ t.transaction_date }}</td>
          <td>{{ t.type.value }}</td>
          <td>{{ t.category.name }}</td>
          <td class="amount-{{ t.type.value }}">{{ "%.2f"|format(t.amount|float) }}</td>
          <td>{{ t.description or '—' }}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
  <p class="mt-2"><a href="{{ request.url_for('transactions_list') }}">View all transactions</a> · <a href="{{ request.url_for('insights_page') }}">Insights</a></p>
  {% else %}
  <div class="empty-state">
    <p>No transactions yet. Add your first one to see your finances at a glance.</p>
    <a href="{{ request.url_for('transaction_new') }}">Add transaction</a>
  </div>
  {% endif %}
</section>
{% endblock %}
